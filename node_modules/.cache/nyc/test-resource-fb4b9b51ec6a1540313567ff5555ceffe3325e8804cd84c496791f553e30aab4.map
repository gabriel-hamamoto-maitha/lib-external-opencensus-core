{"version":3,"file":"/Users/usermaitha/trademaster/libs/lib-external-opencensus-node/test/test-resource.ts","sources":["/Users/usermaitha/trademaster/libs/lib-external-opencensus-node/test/test-resource.ts"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;GAcG;;AAEH,iCAAiC;AAEjC,uDAAwD;AAGxD,QAAQ,CAAC,YAAY,EAAE,GAAG,EAAE;IAC1B,MAAM,CAAC,GAAG,EAAE;QACV,OAAO,CAAC,GAAG,CAAC,gBAAgB,GAAG,kBAAkB,CAAC;QAClD,OAAO,CAAC,GAAG,CAAC,kBAAkB;YAC5B,0FAA0F,CAAC;QAC7F,uBAAY,CAAC,KAAK,EAAE,CAAC;IACvB,CAAC,CAAC,CAAC;IAEH,KAAK,CAAC,GAAG,EAAE;QACT,OAAO,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC;QACpC,OAAO,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,+DAA+D,EAAE,GAAG,EAAE;QACvE,MAAM,QAAQ,GAAG,uBAAY,CAAC,8BAA8B,EAAE,CAAC;QAC/D,MAAM,YAAY,GAAG,QAAQ,CAAC,MAAM,CAAC;QACrC,MAAM,cAAc,GAAW;YAC7B,uBAAuB,EAAE,MAAM;YAC/B,uBAAuB,EAAE,WAAW;YACpC,iBAAiB,EAAE,eAAe;SACnC,CAAC;QAEF,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,kBAAkB,CAAC,CAAC;QACtD,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QACxD,MAAM,CAAC,eAAe,CAAC,YAAY,EAAE,cAAc,CAAC,CAAC;IACvD,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,QAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE;IAChC,MAAM,gBAAgB,GAAa,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC;IAC9D,MAAM,kBAAkB,GAAa;QACnC,IAAI,EAAE,SAAS;QACf,MAAM,EAAE,EAAE,CAAC,EAAE,KAAK,EAAE;KACrB,CAAC;IACF,MAAM,UAAU,GAAa,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC;IACxE,MAAM,UAAU,GAAa;QAC3B,IAAI,EAAE,IAAI;QACV,MAAM,EAAE,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE;KACnC,CAAC;IAEF,EAAE,CAAC,yCAAyC,EAAE,GAAG,EAAE;QACjD,MAAM,SAAS,GAAe,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;QAC7D,MAAM,QAAQ,GAAG,uBAAY,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QACxD,MAAM,cAAc,GAAW,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC;QAElD,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QACxC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC3D,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;IAC1D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,4DAA4D,EAAE,GAAG,EAAE;QACpE,MAAM,SAAS,GAAe;YAC5B,gBAAgB;YAChB,UAAU;YACV,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,EAAE;SAC3B,CAAC;QACF,MAAM,QAAQ,GAAG,uBAAY,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QACxD,MAAM,cAAc,GAAW,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC;QAElD,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QACxC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC3D,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;IAC1D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,4DAA4D,EAAE,GAAG,EAAE;QACpE,MAAM,SAAS,GAAe;YAC5B,gBAAgB;YAChB,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,EAAE;YAC1B,UAAU;SACX,CAAC;QACF,MAAM,QAAQ,GAAG,uBAAY,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QACxD,MAAM,cAAc,GAAW,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC;QAE1D,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QACxC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC3D,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;IAC1D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qDAAqD,EAAE,GAAG,EAAE;QAC7D,MAAM,SAAS,GAAe,CAAC,kBAAkB,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;QAC3E,MAAM,QAAQ,GAAG,uBAAY,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QACxD,MAAM,cAAc,GAAW,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC;QAE5D,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;QAC7C,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAC3D,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;IAC1D,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["/**\n * Copyright 2018, OpenCensus Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as assert from 'assert';\n\nimport { CoreResource } from '../src/resource/resource';\nimport { Labels, Resource } from '../src/resource/types';\n\ndescribe('Resource()', () => {\n  before(() => {\n    process.env.OC_RESOURCE_TYPE = 'k8s.io/container';\n    process.env.OC_RESOURCE_LABELS =\n      'k8s.io/pod/name=\"pod-xyz-123\",k8s.io/container/name=\"c1\",k8s.io/namespace/name=\"default\"';\n    CoreResource.setup();\n  });\n\n  after(() => {\n    delete process.env.OC_RESOURCE_TYPE;\n    delete process.env.OC_RESOURCE_LABELS;\n  });\n\n  it('should return resource information from environment variables', () => {\n    const resource = CoreResource.createFromEnvironmentVariables();\n    const actualLabels = resource.labels;\n    const expectedLabels: Labels = {\n      'k8s.io/container/name': '\"c1\"',\n      'k8s.io/namespace/name': '\"default\"',\n      'k8s.io/pod/name': '\"pod-xyz-123\"',\n    };\n\n    assert.strictEqual(resource.type, 'k8s.io/container');\n    assert.strictEqual(Object.keys(actualLabels).length, 3);\n    assert.deepStrictEqual(actualLabels, expectedLabels);\n  });\n});\n\ndescribe('mergeResources()', () => {\n  const DEFAULT_RESOURCE: Resource = { type: null, labels: {} };\n  const DEFAULT_RESOURCE_1: Resource = {\n    type: 'default',\n    labels: { a: '100' },\n  };\n  const RESOURCE_1: Resource = { type: 't1', labels: { a: '1', b: '2' } };\n  const RESOURCE_2: Resource = {\n    type: 't2',\n    labels: { a: '1', b: '3', c: '4' },\n  };\n\n  it('merge resources with default, resource1', () => {\n    const resources: Resource[] = [DEFAULT_RESOURCE, RESOURCE_1];\n    const resource = CoreResource.mergeResources(resources);\n    const expectedLabels: Labels = { a: '1', b: '2' };\n\n    assert.strictEqual(resource.type, 't1');\n    assert.strictEqual(Object.keys(resource.labels).length, 2);\n    assert.deepStrictEqual(resource.labels, expectedLabels);\n  });\n\n  it('merge resources with default, resource1, resource2 = empty', () => {\n    const resources: Resource[] = [\n      DEFAULT_RESOURCE,\n      RESOURCE_1,\n      { type: null, labels: {} },\n    ];\n    const resource = CoreResource.mergeResources(resources);\n    const expectedLabels: Labels = { a: '1', b: '2' };\n\n    assert.strictEqual(resource.type, 't1');\n    assert.strictEqual(Object.keys(resource.labels).length, 2);\n    assert.deepStrictEqual(resource.labels, expectedLabels);\n  });\n\n  it('merge resources with default, resource1 = empty, resource2', () => {\n    const resources: Resource[] = [\n      DEFAULT_RESOURCE,\n      { type: null, labels: {} },\n      RESOURCE_2,\n    ];\n    const resource = CoreResource.mergeResources(resources);\n    const expectedLabels: Labels = { a: '1', b: '3', c: '4' };\n\n    assert.strictEqual(resource.type, 't2');\n    assert.strictEqual(Object.keys(resource.labels).length, 3);\n    assert.deepStrictEqual(resource.labels, expectedLabels);\n  });\n\n  it('merge resources with default1, resource1, resource2', () => {\n    const resources: Resource[] = [DEFAULT_RESOURCE_1, RESOURCE_1, RESOURCE_2];\n    const resource = CoreResource.mergeResources(resources);\n    const expectedLabels: Labels = { a: '100', b: '2', c: '4' };\n\n    assert.strictEqual(resource.type, 'default');\n    assert.strictEqual(Object.keys(resource.labels).length, 3);\n    assert.deepStrictEqual(resource.labels, expectedLabels);\n  });\n});\n"]}